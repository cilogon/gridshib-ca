#!/bin/sh
######################################################################
#
# Clean up html generated by pod2html.
#
# Currently this entails removing a lead xml header line because it
# causes problems on the Globus web servers. See
# http://bugzilla.globus.org/bugzilla/show_bug.cgi?id=5894 for
# details.
#
# Usage: clean-pod2html.sh <file to clean>
# 
# $Id$
#
######################################################################
#
# Binaries

GREP=@GREP@
MKTEMP=@MKTEMP@
MV=@MV@
RM=@RM@
TAIL=@TAIL@

######################################################################
#
# Get our argument

if test $# -ne 1 ; then
    echo "Usage: $0 <file to clean>"
    exit 1
fi

file=$1
shift

if test -f $file ; then
    :
else
    echo "$0: File $file does not exist"
    exit 1
fi

######################################################################
#
# See if it has the xml header

$GREP '<?xml version="1.0" ?>' $file > /dev/null

if test $? -eq 0 ; then
    # Header found, clean the file

    # Exit on any error
    tmpFile=`$MKTEMP /tmp/clean-pod2html.XXXXXX` 
    $MV $file $tmpFile
    $TAIL +2 $tmpFile > $file
    $RM -f $tmpFile
fi

######################################################################
#
# Success

exit 0

